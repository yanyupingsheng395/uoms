<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="edge" />
    <title>用户成长系统</title>
    <link rel="shortcut icon" type="image/png" th:href="@{/images/favicon.ico}" />
    <!--<link rel="stylesheet" data-th-href="@{/css/bootstrap.min.css}"/>-->
    <link rel="stylesheet" data-th-href="@{/css/bootstrap.min.css}"/>
    <link rel="stylesheet" data-th-href="@{/css/materialdesignicons.min.css}"/>
    <link rel="stylesheet" data-th-href="@{/css/animate.css}"/>
    <!--时间选择插件-->
    <link rel="stylesheet" data-th-href="@{/plugins/bootstrap-datetimepicker/bootstrap-datetimepicker.css}">
    <!--日期选择插件-->
    <link rel="stylesheet" data-th-href="@{/plugins/bootstrap-datepicker/bootstrap-datepicker3.css}">
    <link rel="stylesheet" data-th-href="@{/plugins/confirm/jquery-confirm.min.css}">
    <link rel="stylesheet" data-th-href="@{/plugins/jsmind/jsmind.css}"/>
    <link rel="stylesheet" data-th-href="@{/css/style.min.css}"/>
    <style>
        #jsmind_container{
            width:100%;
            height:320px;
            background:#ffffff;
        }
    </style>
</head>
<body class="gray-bg">
<!-- 公共组件 -->
<div data-th-include="common/commonCSS"></div>
<div class="lyear-layout-web">
    <div class="lyear-layout-container">
        <!-- 左侧导航 -->
        <div data-th-include="common/aside"></div>
        <!-- 头部信息 -->
        <div data-th-include="common/header"></div>
        <!-- 页面主要内容 -->
        <main class="lyear-layout-content">
            <div class="container-div ui-layout-center">
                <div class="row">
                    <div class="col-lg-12 select-table table-striped">
                        <div class="col-md-12">
                            <div class="row">
                                <span class="navbar-page-title">用户成长监控</span>
                            </div>
                            <div class="row">
                                <hr class="hr"/>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="row">
                                <form id="user-form">
                                    <div class="select-list" id="selectCondition1">
                                        <ul>
                                            <li>
                                                周期：
                                                <select name="" id="period">
                                                    <option value="Y">年</option>
                                                    <option value="M" selected>月</option>
                                                    <option value="D">日</option>
                                                </select>
                                            </li>
                                            <li>
                                                开始时间：
                                                <input type="text" name="startDt" class="js-datepicker" id="startDt" value="2019"/>
                                            </li>
                                            <li>
                                                结束时间：
                                                <input type="text" name="endDt" class="js-datepicker" id="endDt" value="2019"/>
                                            </li>
                                            <li>
                                                渠道：
                                                <select name="source" id="source"></select>
                                            </li>
                                            <li id="btns" class="pull-right">
                                                <a class="btn btn-primary btn-rounded btn-sm" onclick="searchKpiInfo()"><i class="fa fa-search"></i>&nbsp;搜索</a>
                                                <a class="btn btn-warning btn-rounded btn-sm" onclick="resetCondition1()"><i class="fa fa-refresh"></i>&nbsp;重置</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="select-list" id="selectCondition2" hidden>
                                        <ul>
                                            <li>
                                                日期：<input class="js-datepicker" type="text" id="startDateOfRetention" name="startDate" data-date-format="yyyy-mm" value="2019-01"/>
                                            </li>
                                            <li>
                                                <a class="btn btn-primary btn-rounded btn-sm" onclick="searchData()"><i class="fa fa-search"></i>&nbsp;搜索</a>
                                                <a class="btn btn-warning btn-rounded btn-sm" onclick="resetCondition2()"><i class="fa fa-refresh"></i>&nbsp;重置</a>
                                            </li>
                                        </ul>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 select-table">
                        <ul class="nav nav-tabs nav-justified" id="navTabs1">
                            <li class="active">
                                <a data-toggle="tab" href="#overview" aria-expanded="true">概览</a>
                            </li>
                            <li class="nav-item">
                                <a data-toggle="tab" href="#gmv" aria-expanded="false">GMV</a>
                            </li>
                            <li class="nav-item">
                                <a data-toggle="tab" href="#user-num">用户数</a>
                            </li>
                            <li class="nav-item">
                                <a data-toggle="tab" href="#customer-unit-price">客单价</a>
                            </li>
                            <li class="nav-item">
                                <a data-toggle="tab" href="#retention">留存率</a>
                            </li>
                            <li class="nav-item">
                                <a data-toggle="tab" href="#order-num">订单数</a>
                            </li>
                            <li class="nav-item">
                                <a data-toggle="tab" href="#order-price">订单价</a>
                            </li>
                            <li class="nav-item">
                                <a data-toggle="tab" href="#joint-rate">连带率</a>
                            </li>
                            <li class="nav-item">
                                <a data-toggle="tab" href="#unit-price">件单价</a>
                            </li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane fade active in" id="overview">
                                <div data-th-include="operate/useroperator/jsmind"></div>
                            </div>
                            <div class="tab-pane fade" id="gmv"></div>
                            <div class="tab-pane fade" id="user-num"></div>
                            <div class="tab-pane fade" id="customer-unit-price"></div>
                            <div class="tab-pane fade" id="retention">
                                <div data-th-include="operate/useroperator/cohort"></div>
                            </div>
                            <div class="tab-pane fade" id="order-num"></div>
                            <div class="tab-pane fade" id="order-price"></div>
                            <div class="tab-pane fade" id="joint-rate"></div>
                            <div class="tab-pane fade" id="unit-price"></div>
                        </div>
                        <div id="template" style="display:none;">
                            <div data-th-include="operate/useroperator/kpival"></div>
                        </div>
                        <div id="retentionTmp" style="display:none;">
                            <div data-th-include="operate/useroperator/cohort"></div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
<div data-th-include="common/commonJS"></div>
<!--时间选择插件-->
<script data-th-src="@{/plugins/bootstrap-datetimepicker/moment.min.js}"></script>
<script data-th-src="@{/plugins/bootstrap-datetimepicker/bootstrap-datetimepicker.min.js}"></script>
<script data-th-src="@{/plugins/bootstrap-datetimepicker/locale/zh-cn.js}"></script>
<!--日期选择插件-->
<script data-th-src="@{/plugins/bootstrap-datepicker/bootstrap-datepicker.min.js}"></script>
<script data-th-src="@{/plugins/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN.min.js}"></script>
<script data-th-src="@{/plugins/confirm/jquery-confirm.min.js}"></script>
<script data-th-src="@{/plugins/jsmind/jsmind.js}"></script>
<script data-th-src="@{/plugins/jsmind/jsmind.draggable.js}"></script>
<script data-th-src="@{/plugins/echarts/echarts.min.js}"></script>
<script data-th-src="@{/plugins/echarts/macarons.js}"></script>
<script data-th-src="@{/js/app/operate/common/template.js}"></script>
<script data-th-src="@{/js/app/operate/useroperator/monitor.js}"></script>
<script data-th-src="@{/js/app/operate/useroperator/cohort.js}"></script>

<script>
    init_date_begin("startDt", "endDt", "yyyy-mm",1,2 ,1);
    init_date_end("startDt", "endDt", "yyyy-mm",1,2 ,1);
    $('#startDt').datepicker("setEndDate", new Date());
    $('#endDt').datepicker("setEndDate", new Date());
    var currentYear = new Date().getFullYear();
    var currentMonth = new Date().getMonth() + 1;
    $("#startDt").val(currentYear + "-01");
    $("#endDt").val(currentYear + "-" + (currentMonth < 10 ? "0" + currentMonth : currentMonth));

    init_date("startDateOfRetention", "yyyy-mm", 1,2,1);
    var d = new Date();
    d.setMonth(d.getMonth());
    $("#startDateOfRetention").datepicker('setEndDate',d);
</script>
</body>
</html>