<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.linksteady.qywx.dao.WelcomeMessageMapper">

    <resultMap id="paramMap" type="com.linksteady.qywx.domain.WelcomeMpParam">
        <result column="wc_media_id" jdbcType="VARCHAR" property="wcMediaId"/>
        <result column="wc_media_expire_date" jdbcType="TIMESTAMP" property="wcMediaExpireDate"/>
        <result column="wc_media_content" property="wcMediaContent" typeHandler="org.apache.ibatis.type.ByteArrayTypeHandler"/>
    </resultMap>

    <select id="getWelcomeMpParam" resultMap="paramMap">
         select wc_media_id,wc_media_expire_date,wc_media_content from uo_qywx_param limit 1
    </select>

    <update id="updateWcMediaExpireInfo">
        update uo_qywx_param set wc_media_id=#{mediaId},wc_media_expire_date=#{expreDt}
    </update>

    <select id="getValidWelcome" resultType="com.linksteady.qywx.domain.QywxWelcome">
        select id, welcome_name, content, insert_by, insert_dt, policy_type,
        pic_url, pic_id, link_title, link_picurl, link_desc, link_url,
         miniprogram_title, miniprogram_page,
         qywx_coupon_id, qywx_product_id,
         update_dt, update_by, valid_flag, status
         from uo_qywx_welcome
          where status='1'
        order by insert_dt desc limit 1
    </select>

</mapper>